#Region System
FEEDSTRINGS;
SKIPCHECK;
UNDEFVALS;
#EndRegion
UNDEFVALS;
#UNDEFVALS;

#Region N-Calculation rules: Dimension:Depreciation
#Autogenerated CALC NUMERIC 446570726563696174696F6E
   #Region Dimension:Depreciation, Member:YTD Additions
   #Autogenerated MEMBERCALC NUMERIC 5B446570726563696174696F6E5D2E5B595444204164646974696F6E735D
   ##CUMULATE : calculates the cumulative totals in output member cell based on the orginal values in the input member cell
   ['Depreciation':'YTD Additions']=N:DB('Depreciation', !organization, !Asset Types, !Month, !Year, !Version, 'Additions')+DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'previousperiod'), !Year, !Version, 'YTD Additions');
   #EndRegion
   #Region Dimension:Depreciation, Member:YTD In Service
   #Autogenerated MEMBERCALC NUMERIC 5B446570726563696174696F6E5D2E5B59544420496E20536572766963655D
   ##CUMULATE : calculates the cumulative totals in output member cell based on the orginal values in the input member cell
   ['Depreciation':'YTD In Service']=N:DB('Depreciation', !organization, !Asset Types, !Month, !Year, !Version, 'In Service')+DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'previousperiod'), !Year, !Version, 'YTD In Service');
   #EndRegion
   #Region Dimension:Depreciation, Member:Cost End Bal
   #Autogenerated MEMBERCALC NUMERIC 5B446570726563696174696F6E5D2E5B436F737420456E642042616C5D
   ['Depreciation':'Cost End Bal']=N:((['Depreciation':'Cost Beg Bal']+['Depreciation':'In Service'])+['Depreciation':'Adjustments']);
   #EndRegion
#EndRegion

#Region C-Calculation rules: Dimension:Depreciation
#Autogenerated CALC CONSOLIDATED 446570726563696174696F6E
   #Region Dimension:Depreciation, Member:YTD Additions
   #Autogenerated MEMBERCALC CONSOLIDATED 5B446570726563696174696F6E5D2E5B595444204164646974696F6E735D
   ##CUMULATE : calculates the cumulative totals in output member cell based on the orginal values in the input member cell
   ['Month':{'Year', 'YTD', 'Q1', 'Q2', 'Q3', 'Q4', 'Jan YTD', 'Feb YTD', 'Mar YTD', 'Apr YTD', 'May YTD', 'Jun YTD', 'Jul YTD', 'Aug YTD', 'Oct YTD', 'Nov YTD', 'Dec YTD', 'Sep YTD'}, 'Depreciation':{'YTD Additions'}]=C:IF(DIMIX('Month', ATTRS('Month', !
   Month, 'lastperiod'))>0,
   DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'lastperiod'), !Year, !Version, 'YTD Additions'),
   DB('Depreciation', !organization, !Asset Types, ELCOMP('Month', !Month, ELCOMPN('Month', !Month)), !Year, !Version, 'YTD Additions'));
   #EndRegion
   #Region Dimension:Depreciation, Member:YTD In Service
   #Autogenerated MEMBERCALC CONSOLIDATED 5B446570726563696174696F6E5D2E5B59544420496E20536572766963655D
   ##CUMULATE : calculates the cumulative totals in output member cell based on the orginal values in the input member cell
   ['Month':{'Year', 'YTD', 'Q1', 'Q2', 'Q3', 'Q4', 'Jan YTD', 'Feb YTD', 'Mar YTD', 'Apr YTD', 'May YTD', 'Jun YTD', 'Jul YTD', 'Aug YTD', 'Oct YTD', 'Nov YTD', 'Dec YTD', 'Sep YTD'}, 'Depreciation':{'YTD In Service'}]=C:IF(DIMIX('Month', ATTRS('Month', 
   !Month, 'lastperiod'))>0,
   DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'lastperiod'), !Year, !Version, 'YTD In Service'),
   DB('Depreciation', !organization, !Asset Types, ELCOMP('Month', !Month, ELCOMPN('Month', !Month)), !Year, !Version, 'YTD In Service'));
   #EndRegion
   #Region Dimension:Depreciation, Member:Cost End Bal
   #Autogenerated MEMBERCALC CONSOLIDATED 5B446570726563696174696F6E5D2E5B436F737420456E642042616C5D
   ['Month':{'Year', 'YTD', 'Q1', 'Q2', 'Q3', 'Q4', 'Jan YTD', 'Feb YTD', 'Mar YTD', 'Apr YTD', 'May YTD', 'Jun YTD', 'Jul YTD', 'Aug YTD', 'Oct YTD', 'Nov YTD', 'Dec YTD', 'Sep YTD'}, 'Depreciation':{'Cost End Bal'}]=C:IF(DIMIX('Month', ATTRS('Month', !M
   onth, 'lastperiod'))>0,
   DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'lastperiod'), !Year, !Version, 'Cost End Bal'),
   DB('Depreciation', !organization, !Asset Types, ELCOMP('Month', !Month, ELCOMPN('Month', !Month)), !Year, !Version, 'Cost End Bal'));
   #EndRegion
   #Region Dimension:Depreciation, Member:Depr Beg Bal
   #Autogenerated MEMBERCALC CONSOLIDATED 5B446570726563696174696F6E5D2E5B44657072204265672042616C5D
   ['Month':{'Year', 'YTD', 'Q1', 'Q2', 'Q3', 'Q4', 'Jan YTD', 'Feb YTD', 'Mar YTD', 'Apr YTD', 'May YTD', 'Jun YTD', 'Jul YTD', 'Aug YTD', 'Oct YTD', 'Nov YTD', 'Dec YTD', 'Sep YTD'}, 'Depreciation':{'Depr Beg Bal'}]=C:IF(DIMIX('Month', ATTRS('Month', !M
   onth, 'firstperiod'))>0,
   DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'firstperiod'), !Year, !Version, 'Depr Beg Bal'),
   DB('Depreciation', !organization, !Asset Types, ELCOMP('Month', !Month, 1), !Year, !Version, 'Depr Beg Bal'));
   #EndRegion
   #Region Dimension:Depreciation, Member:Depr End Bal
   #Autogenerated MEMBERCALC CONSOLIDATED 5B446570726563696174696F6E5D2E5B4465707220456E642042616C5D
   ['Month':{'Year', 'YTD', 'Q1', 'Q2', 'Q3', 'Q4', 'Jan YTD', 'Feb YTD', 'Mar YTD', 'Apr YTD', 'May YTD', 'Jun YTD', 'Jul YTD', 'Aug YTD', 'Oct YTD', 'Nov YTD', 'Dec YTD', 'Sep YTD'}, 'Depreciation':{'Depr End Bal'}]=C:IF(DIMIX('Month', ATTRS('Month', !M
   onth, 'lastperiod'))>0,
   DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'lastperiod'), !Year, !Version, 'Depr End Bal'),
   DB('Depreciation', !organization, !Asset Types, ELCOMP('Month', !Month, ELCOMPN('Month', !Month)), !Year, !Version, 'Depr End Bal'));
   #EndRegion
   #Region Dimension:Depreciation, Member:Asset Beg Bal
   #Autogenerated MEMBERCALC CONSOLIDATED 5B446570726563696174696F6E5D2E5B4173736574204265672042616C5D
   ['Month':{'Year', 'YTD', 'Q1', 'Q2', 'Q3', 'Q4', 'Jan YTD', 'Feb YTD', 'Mar YTD', 'Apr YTD', 'May YTD', 'Jun YTD', 'Jul YTD', 'Aug YTD', 'Oct YTD', 'Nov YTD', 'Dec YTD', 'Sep YTD'}, 'Depreciation':{'Asset Beg Bal'}]=C:IF(DIMIX('Month', ATTRS('Month', !
   Month, 'firstperiod'))>0,
   DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'firstperiod'), !Year, !Version, 'Asset Beg Bal'),
   DB('Depreciation', !organization, !Asset Types, ELCOMP('Month', !Month, 1), !Year, !Version, 'Asset Beg Bal'));
   #EndRegion
   #Region Dimension:Depreciation, Member:Asset End Bal
   #Autogenerated MEMBERCALC CONSOLIDATED 5B446570726563696174696F6E5D2E5B417373657420456E642042616C5D
   ['Month':{'Year', 'YTD', 'Q1', 'Q2', 'Q3', 'Q4', 'Jan YTD', 'Feb YTD', 'Mar YTD', 'Apr YTD', 'May YTD', 'Jun YTD', 'Jul YTD', 'Aug YTD', 'Oct YTD', 'Nov YTD', 'Dec YTD', 'Sep YTD'}, 'Depreciation':{'Asset End Bal'}]=C:IF(DIMIX('Month', ATTRS('Month', !
   Month, 'lastperiod'))>0,
   DB('Depreciation', !organization, !Asset Types, ATTRS('Month', !Month, 'lastperiod'), !Year, !Version, 'Asset End Bal'),
   DB('Depreciation', !organization, !Asset Types, ELCOMP('Month', !Month, ELCOMPN('Month', !Month)), !Year, !Version, 'Asset End Bal'));
   #EndRegion
#EndRegion

#Region Link rule: Dep:Cap_Additions - Numeric
#Source cube: Capital
#Target cube: Depreciation
#Autogenerated LINK NUMERIC 7D4C696E6B5F4465705F33414361705F4164646974696F6E73
['Depreciation':'Additions'] = N:(DB('}ICube_}Link_Dep_3ACap_Additions',
    !Month, !organization, '1', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_Additions',
    !Month, !organization, '2', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_Additions',
    !Month, !organization, '3', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_Additions',
    !Month, !organization, '4', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_Additions',
    !Month, !organization, '5', !Asset Types, !Year, !Version,
    'Purchase Cost'));
#EndRegion

#Region Link rule: Dep:Cap_InService - Numeric
#Source cube: Capital
#Target cube: Depreciation
#Autogenerated LINK NUMERIC 7D4C696E6B5F4465705F33414361705F496E53657276696365
['Depreciation':'In Service'] = N:(DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '1', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '2', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '3', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '4', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '5', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '6', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '7', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '8', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '9', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '10', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '11', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '12', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '13', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '14', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '15', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '16', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '17', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '18', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '19', !Asset Types, !Year, !Version,
    'Purchase Cost') + DB('}ICube_}Link_Dep_3ACap_InService',
    !Month, !organization, '20', !Asset Types, !Year, !Version,
    'Purchase Cost'));
#EndRegion

#Region Custom Calc
   #Region Beb Bal
   ['Cost Beg Bal']=N:IF((ATTRN('Year',!Year,'Index')=1 & DIMIX('Month',!Month) =3),STET,CONTINUE);
      ['Cost Beg Bal']=N:IF(DIMIX('Month',!Month)=3,
   DB('Depreciation',!Organization,!Asset Types,'Dec',ATTRS('Year',!Year,'Prev'),!Version,'Cost End Bal'),
   DB('Depreciation',!Organization,!Asset Types,ATTRS('Month',!Month,'previousperiod'),!Year,!Version,'Cost End Bal'));
   #EndRegion
   #Region Depreciation
      ['Depr Beg Bal']=N:IF((ATTRN('Year',!Year,'Index')=1 & DIMIX('Month',!Month) =3),STET,CONTINUE);
      ['Depr Beg Bal']=N:IF(DIMIX('Month',!Month)=3,
   DB('Depreciation',!Organization,!Asset Types,'Dec',ATTRS('Year',!Year,'Prev'),!Version,'Depr End Bal'),
   #					DB('Depreciation Calc',!Version,!Asset Types,!Organization,ATTRS('Year',!Year,'Prev'),'Depr End Bal','Dec'),
      DB('Depreciation',!organization,!Asset Types,ATTRS('Month',!Month,'previousperiod'),!Year,!Version,'Depr End Bal'));
   #					DB('Depreciation Calc',!Version,!Asset Types,!Organization,!Year,'Depr End Bal',ATTRS('Month',!Month,'Prev')));
      ['6520 Depr on Additions']=N:['YTD In Service'] \ DB('Asset Life',!Asset Types,!Version,'Asset Life');
            ['Total Depreciation']=N:['6520 Depr on Additions'] + ['6510 Depr on Existing Assets'];
      ['Depr End Bal']=N:['Depr Beg Bal'] + ['Total Depreciation'];
   #===============================BALANCE SHEET=========================================
      ['Asset Beg Bal']=N:IF((ATTRN('Year',!Year,'Index')=1 & DIMIX('Month',!Month) =3),STET,CONTINUE);
      ['Asset Beg Bal']=N:IF(DIMIX('Month',!Month)=3,
   DB('Depreciation',!Organization,!Asset Types,'Dec',ATTRS('Year',!Year,'Prev'),!Version,'Asset End Bal'),
   #					DB('Depreciation Calc',!Version,!Asset Types,!Organization,ATTRS('Year',!Year,'Prev'),'Asset End Bal','Dec'),
      DB('Depreciation',!Organization,!Asset Types,ATTRS('Month',!Month,'previousperiod'),!Year,!Version,'Asset End Bal'));
   #					DB('Depreciation Calc',!Version,!Asset Types,!Organization,!Year,'Asset End Bal',ATTRS('Month',!Month,'Prev')));
      ['Asset End Bal']=N:['Asset Beg Bal'] + ['Additions']-['Total Depreciation'];
   #EndRegion



#EndRegion



FEEDERS;


#Region FEED The Income Statement
#['6510']=>DB(IF(ATTRS('Version',!Version,'LinkVersion')@<>'','Income Statement',''),'Local', !organization, !Year, !Month, '6510', !Version);
#['6520']=>DB(IF(ATTRS('Version',!Version,'LinkVersion')@<>'','Income Statement',''),'Local', !organization, !Year, !Month, '6520', !Version);
#EndRegion